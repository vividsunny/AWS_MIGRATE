jQuery(document).ready(function(r){"use strict";if("undefined"!=typeof yith_wacp){var a,c=r("#yith-wacp-popup"),t=c.find(".yith-wacp-overlay"),e=c.find(".yith-wacp-close"),i=undefined,o=function(){r("html").removeClass("yith_wacp_open"),c.removeClass("open mini_cart"),setTimeout(function(){a.destroy()},1e3),r(document).trigger("yith_wacp_popup_after_closing")},n=function(){var t=c.find(".yith-wacp-wrapper"),e=r(window).width(),a=r(window).height(),n=e-60>yith_wacp.popup_size.width?yith_wacp.popup_size.width:e-60,i=a-120>yith_wacp.popup_size.height?yith_wacp.popup_size.height:a-120;t.css({left:e/2-n/2,top:a/2-i/2,width:n+"px",height:i+"px"})},p=function(){var t=r("#yith-wacp-mini-cart"),e=r(window).width(),a=r(window).height()*(yith_wacp.mini_cart_position.top/100)-t.innerHeight(),n=e*(yith_wacp.mini_cart_position.left/100)-t.innerWidth();t.css({left:n,top:a}).show()},d=function(t){var e=c.find(".yith-wacp-content");return void 0!==t&&e.html(t),c.hasClass("open")?("undefined"!=typeof PerfectScrollbar&&a.update(),e.scrollTop(0),r(document).trigger("yith_wacp_popup_changed",[c])):(r(document).trigger("yith_wacp_popup_before_opening",[c]),n(),"undefined"!=typeof PerfectScrollbar&&(a=new PerfectScrollbar(".yith-wacp-content",{suppressScrollX:!0})),yith_wacp.is_mobile&&r("html").addClass("yith_wacp_open"),c.addClass("open"),r(document).trigger("yith_wacp_popup_after_opening",[c])),!1},_=function(){void 0!==i&&(c.addClass("mini_cart"),d(i))},s=function(t){0<t?r("#yith-wacp-mini-cart").removeClass("empty"):r("#yith-wacp-mini-cart").addClass("empty"),r(".yith-wacp-mini-cart-count").length&&r(".yith-wacp-mini-cart-count").html(t),r(document).trigger("yith_wacp_cart_counter_updated")},h=function(t){t.block({message:null,overlayCSS:{background:"#fff url("+yith_wacp.loader+") no-repeat center",opacity:.5,cursor:"none"}})},u=function(t,e,a){r(document).trigger("yith_wacp_adding_cart_single"),a.addClass("loading").removeClass("added"),r.ajax({url:window.location,data:t,contentType:!1,processData:!1,dataType:"json",type:"POST",success:function(t){t.error.length?(e.parents("div.product").before(t.error),r("body, html").animate({scrollTop:0},500),e.find(".gfield input, .gfield textarea, .gfield select ").each(function(){r(this).val()||r(this).closest(".gfield").addClass("gfield_error")})):t.html&&(d(t.html),i=t.cart_html,r(document.body).trigger("wc_fragment_refresh").trigger("wacp_single_added_to_cart"),s(t.items))},complete:function(){a.removeAttr("disabled").removeClass("loading").addClass("added")}})};if(r("body").on("added_to_cart cleverswatch_after_add_to_cart",function(t,e,a,n){void 0===e&&(e=r.parseJSON(sessionStorage.getItem(wc_cart_fragments_params.fragment_name))),"undefined"!=typeof e.yith_wacp_message&&(yith_wacp.allow_automatic_popup&&d(c.hasClass("mini_cart")?e.yith_wacp_message_cart:e.yith_wacp_message),i=e.yith_wacp_message_cart,s(e.yith_wacp_cart_items))}),r(document).on("yith_wwraq_added_successfully",function(t,e){"undefined"!=typeof e.yith_wacp_raq&&d(e.yith_wacp_raq)}),c.on("click",".yith-wacp-remove-cart, .item-remove a.remove",function(t){t.preventDefault();var e=r(this),a=e.data("item_key")?e.data("item_key"):function(t,e){var a,n,i=t.split("&");for(n=0;n<i.length;n++)if((a=i[n].split("="))[0]===e)return a[1]===undefined||a[1]}(e.attr("href"),"remove_item"),n={action:yith_wacp.actionRemove,item_key:a,context:"frontend"};h(e.parents("table")),r.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionRemove),data:n,dataType:"json",success:function(t){""!=t.html?(c.find(".yith-wacp-content").html(t.html),r(document).trigger("yith_wacp_popup_changed",[c]),r(document.body).trigger("wc_fragment_refresh")):(r(document.body).trigger("wc_fragment_refresh"),i=undefined,o()),s(t.items),i=t.html}})}),r(document).keydown(function(t){27==t.keyCode&&o()}),c.on("change","table.cart-list input.qty",function(t){t.preventDefault();var e=r(this),a={action:yith_wacp.actionUpdate,item_key:e.attr("name").replace(/\[|\]|qty/gi,""),qty:e.val(),context:"frontend"};h(e.parents("table")),r.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionUpdate),data:a,dataType:"json",success:function(t){""!=t.html&&(c.find(".yith-wacp-content").html(t.html),r(document).trigger("yith_wacp_popup_changed",[c]),r(document.body).trigger("wc_fragment_refresh")),s(t.items),i=t.html}})}),c.on("click","a.continue-shopping",function(t){"#"==r(this).attr("href")&&(t.preventDefault(),o())}),c.on("submit","#yith-ywraq-form",function(t){t.preventDefault();var e=r(this).serializeArray();e.push({name:"action",value:yith_wacp.actionUpdateRaq},{name:"context",value:"frontend"}),r.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionUpdateRaq),data:r.param(e),dataType:"json",type:"POST",success:function(t){d(t.yith_wacp_raq)}})}),t.on("click",o),e.on("click",function(t){t.preventDefault(),o()}),r(window).on("resize yith_wacp_popup_changed",n),r(document).on("submit",yith_wacp.form_selectors,function(t){var e,a=r(this),n=a.find('button[type="submit"]:focus'),i=a.find('input[name="yith-wacp-is-excluded"]'),c="is_one_click"==a.find('input[name="_yith_wocc_one_click"]').val();if("undefined"!=typeof wc_cart_fragments_params&&yith_wacp.enable_single&&1!==r(this).parents(".product-type-external").length&&!n.hasClass("wcsatt-add-to-subscription-button")&&!i.length&&!c){t.preventDefault();var o=new FormData;r.each(a.find("input[type='file']"),function(t,a){r.each(r(a)[0].files,function(t,e){o.append(a.name,e)})});var p=!1;e=a.serializeArray(),r.each(e,function(t,e){"add-to-cart"==e.name&&(p=!0),o.append(e.name,e.value)}),o.append("context","frontend"),o.append("action",yith_wacp.actionAdd),p||o.append("add-to-cart",a.find('button[name="add-to-cart"]').val()),u(o,a,n)}}),r(document).on("yith_wacp_popup_after_opening yith_wacp_popup_changed",function(){"undefined"!=typeof r.yith_wccl&&"undefined"!=typeof r.fn.wc_variation_form&&(r(document).find(".variations_form:not(.initialized)").each(function(){r(this).wc_variation_form()}),r.yith_wccl()),"undefined"!=typeof thb_lazyload&&thb_lazyload.update()}),r(document).on("submit",".yith-wfbt-form",function(t){if("undefined"!=typeof yith_wacp.actionAddFBT){t.preventDefault();var e=r(this),a=e.find('button[type="submit"]'),n=new FormData,i=e.serializeArray();r.each(i,function(t,e){n.append(e.name,e.value)}),n.append("context","frontend"),n.append("actionAjax",yith_wacp.actionAddFBT),n.append("action","yith_bought_together"),n.append("_wpnonce",yith_wacp.nonceFBT),u(n,e,a)}}),"undefined"!=typeof yith_wacp.actionUpdateMiniCart&&r("#yith-wacp-mini-cart").length){r(window).on("resize",p),p(),h(r("#yith-wacp-mini-cart")),r.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionUpdateMiniCart),data:{action:yith_wacp.actionUpdateMiniCart,context:"frontend"},dataType:"json",success:function(t){i=t.html,s(t.items),r(document).on("click",yith_wacp.open_popup_selectors,_)},complete:function(){r("#yith-wacp-mini-cart").unblock()}})}}});
jQuery(document).ready(function(p){"use strict";var n="undefined"!=typeof yith_ywpar_admin&&yith_ywpar_admin.block_loader;p("#ywpar_apply_points_from_wc_points_rewards_btn").on("click",function(e){e.preventDefault();var r=p(this).prev().val(),a=p("#ywpar_apply_points_from_wc_points_rewards_btn").closest(".option");a.find(".response").remove(),n&&a.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),p.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_apply_wc_points_rewards&from="+r+"&security="+yith_ywpar_admin.apply_wc_points_rewards,success:function(e){a.unblock(),a.append('<span class="response">'+e+"</span>")}})}),p("#yit_ywpar_options_fix_expiration_points-container .button").on("click",function(e){e.preventDefault();var r=p("#yit_ywpar_options_fix_expiration_points-container");r.find(".response").remove(),n&&r.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),p.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_fix_expiration_points&security="+yith_ywpar_admin.fix_expiration_points,success:function(e){r.unblock(),r.append('<span class="response">'+e+"</span>"),location.reload(!1)}})}),p("#ywpar-notice-is-dismissable").find(".notice-dismiss").on("click",function(){p.cookie("ywpar_notice","dismiss",{path:"/"})}),p(document).on("click","#yith_woocommerce_points_and_rewards_points .ywpar-remove-row",function(){p(this).closest(".role-conversion-options").remove()}),p(document).on("click",".extrapoint-options .ywpar-remove-row",function(){p(this).closest(".extrapoint-options").remove()}),p(document).on("click","#yith_woocommerce_points_and_rewards_extra-points .ywpar-add-row",function(){var e=p(this),r=e.closest(".yith-plugin-fw-field-wrapper"),a=e.closest(".extrapoint-options"),t=parseInt(a.data("index")),n=a.clone(),o=r.find(".extrapoint-options"),i=1;o.each(function(){var e=p(this).data("index");i<e&&(i=e)});var s=i+1;n.attr("data-index",s),n.find("[name*='list']").each(function(){var e=p(this),r=e.attr("name"),a=e.attr("id"),n=r.replace("[list]["+t+"]","[list]["+s+"]"),o=a.replace("[list]["+t+"]","[list]["+s+"]");e.attr("name",n),e.attr("id",o),e.val("")}),n.find(".ywpar-remove-row").removeClass("hide-remove"),n.find(".chosen-container").remove(),r.append(n)}),p(document).on("click","#yith_woocommerce_points_and_rewards_points .ywpar-add-row",function(){var e=p(this),r=e.closest(".yith-plugin-fw-field-wrapper"),a=e.closest(".role-conversion-options"),t=parseInt(a.data("index")),n=a.clone(),o=r.find(".role-conversion-options"),i=1;o.each(function(){var e=p(this).data("index");i<e&&(i=e)});var s=i+1;n.attr("data-index",s),n.find("[name*='role_conversion']").each(function(){var e=p(this),r=e.attr("name"),a=e.attr("id"),n=r.replace("[role_conversion]["+t+"]","[role_conversion]["+s+"]"),o=a.replace("[role_conversion]["+t+"]","[role_conversion]["+s+"]");e.attr("name",n),e.attr("id",o),e.val("")}),n.find(".ywpar-remove-row").removeClass("hide-remove"),n.find(".chosen-container").remove(),r.append(n)}),p("#ywpar_apply_points_previous_order-container .panel-datepicker").each(function(){p(this).datepicker({dateFormat:"yy-mm-dd"})}),p("#ywpar_apply_points_previous_order_btn").on("click",function(e){e.preventDefault();var r=p(this).prev().val(),a=p("#ywpar_apply_points_previous_order-container .option");a.find(".response").remove(),n&&a.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),p.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_apply_previous_order&from="+r+"&security="+yith_ywpar_admin.apply_previous_order_none,success:function(e){a.unblock(),a.append('<span class="response">'+e+"</span>")}})}),p(".ywrac_reset_points").on("click",function(e){if(e.preventDefault(),!confirm(yith_ywpar_admin.reset_points_confirm))return!1;var r=p(this).closest(".yith-plugin-fw-field-wrapper");r.find(".response").remove(),n&&r.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),p.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_reset_points&security="+yith_ywpar_admin.reset_points,success:function(e){r.unblock(),r.append('<span class="response">'+e+"</span>")}})}),p("#ywpar_import_points").length&&p("#ywpar_import_points").closest("form").attr("enctype","multipart/form-data"),p("#ywpar_import_points").on("click",function(e){e.preventDefault();var r=p("#type_action").val();p(".ywpar_safe_submit_field").val(r+"_points"),p(this).closest("form").submit()}),p("#type_action").on("change",function(){var e=p(this);"import"==e.val()?e.closest(".option").find("[data-val='import']").show():e.closest(".option").find("[data-val='import']").hide()}),p("#type_action").change(),p(document).on("click",".ywpar_reset_points",function(e){e.preventDefault();var r=p(this),a=r.data("username"),n=yith_ywpar_admin.reset_point_message+" "+a+"?";confirm(n)&&(window.location.href=r.attr("href"))}),p(document).on("change","#ywpar_conversion_rate_method, #ywpar_rewards_points_for_role",function(){var e=p("#ywpar_conversion_rate_method");"yes"==p("#ywpar_rewards_points_for_role").val()?"fixed"==e.val()?(p("#ywpar_rewards_points_role_rewards_fixed_conversion_rate-container").closest("tr").show(),p("#ywpar_rewards_points_role_rewards_percentage_conversion_rate-container").closest("tr").hide()):(p("#ywpar_rewards_points_role_rewards_percentage_conversion_rate-container").closest("tr").show(),p("#ywpar_rewards_points_role_rewards_fixed_conversion_rate-container").closest("tr").hide()):(p("#ywpar_rewards_points_role_rewards_fixed_conversion_rate-container").closest("tr").hide(),p("#ywpar_rewards_points_role_rewards_percentage_conversion_rate-container").closest("tr").hide())}),p("#ywpar_conversion_rate_method").change(),p("#ywpar_rewards_points_for_role").change(),p(document).on("change","#ywpar_type_user_search",function(){var a=p(this).val();p(".ywpar-deps").each(function(){var e=p(this),r=e.data("deps");-1!==(r=r?r.split(","):[]).indexOf(a)?e.show():e.hide()})}),p("#ywpar_bulk_action_type").change(),p(document).on("change","#ywpar_bulk_action_type",function(){var a=p(this).val();p(".ywpar-deps_action").each(function(){var e=p(this),r=e.data("deps");-1!==(r=r?r.split(","):[]).indexOf(a)?e.show():e.hide()})}),p("#ywpar_bulk_action_type").change(),p("#ywpar_bulk_action_points").on("click",function(e){e.preventDefault();var r=p(this).closest("form");p(".ywpar-bulk-trigger").append('<div class="ywpar-bulk-progress"><div>0%</div></div>'),o(1,r.serialize(),r)});var o=function(e,r,a){var n=p(".ywpar-bulk-trigger");p.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,data:{form:r,action:"ywpar_bulk_action",step:e},dataType:"json",success:function(e){"done"==e.step?(n.find(".ywpar-bulk-progress").hide("slow").remove(),window.location=e.url):"error"==e.step?n.find(".ywpar-bulk-progress div").html(e.error):(n.find(".ywpar-bulk-progress div").html(e.percentage+"%"),n.find(".ywpar-bulk-progress div").animate({width:e.percentage+"%"},50,function(){}),o(parseInt(e.step),r,a))}})};p.fn.serializefiles=function(){var e=p(this),a=new FormData,r=p(e).serializeArray();return p.each(r,function(e,r){a.append(r.name,r.value)}),a}});
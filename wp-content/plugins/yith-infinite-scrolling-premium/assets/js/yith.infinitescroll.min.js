/**
 * yith.infinitescroll.js
 *
 * @author Your Inspiration Themes
 * @package YITH Infinite Scrolling
 * @version 1.0.0
 */
!function(m,S,b){"use strict";m.yit_infinitescroll=function(t){function a(t,e){S.location.pathname!=t&&(S.history.replaceState({url:""+t},"Title",t),e&&(b.title=e),m(b).trigger("yith_infs_url_changed",[t,e]))}var c,f=m.extend({nextSelector:"",navSelector:"",itemSelector:"",contentSelector:"",eventType:"scroll",presetLoader:"",customLoader:"",buttonLabel:"",buttonClass:"",loadEffect:"fadeIn"},t),h="undefined"!=typeof yith_infs_script&&yith_infs_script.shop,e="undefined"!=typeof yith_infs_script&&yith_infs_script.block_loader,d=!1,u=!1,n=!1,i=!1,p=m(f.nextSelector).attr("href"),v=[],y=[];if("pagination"!=f.eventType&&m(f.navSelector).hide(),h)var _=m(f.itemSelector).first().nextUntil(".first",f.itemSelector).length+1;function o(){n&&m(f.navSelector).last().after('<div class="yith-infs-loader">'+n+"</div>"),d=!0,p=(p=decodeURIComponent(p)).replace(/^(?:\/\/|[^\/]+)*\//,"/"),m.ajax({url:p,dataType:"html",cache:yith_infs_script.use_cache,success:function(t){c=m(f.itemSelector).last();var e=m(t),n=e.find(f.contentSelector),i=e.find(f.itemSelector),o=e.find(f.navSelector),r=e.find(f.nextSelector),l=p;if(r.length?p=r.attr("href"):(u=!0,m(b).trigger("yith-infs-scroll-finished")),h&&!c.hasClass("last")&&"pagination"!=f.eventType&&g(c,_,i),m(f.navSelector).replaceWith(o),"pagination"!=f.eventType?(c.after(i),m(f.navSelector).hide()):(m(f.contentSelector).replaceWith(n),m(S).scrollTop(m(f.contentSelector).offset().top)),m(".yith-infs-loader").remove(),m(b).trigger("yith_infs_adding_elem",[i,l]),i.addClass("yith-infs-animated"),i.addClass(f.loadEffect),yith_infs_script.change_url){var s=e.filter("title").length?e.filter("title").text():"";"pagination"!=f.eventType&&(v.length||v.push([S.location.href,b.title]),v.push([l,s]),y.push(c)),"scroll"!=f.eventType&&a(l,s)}setTimeout(function(){d=!1,i.removeClass("yith-infs-animated"),i.removeClass(f.loadEffect),m(b).trigger("yith_infs_added_elem",[i,l])},1e3)}})}var r,g=function(t,e,n){var i=e-t.prevUntil(".last",f.itemSelector).length,o=0;n.each(function(){var t=m(this);o++,t.removeClass("first"),t.removeClass("last"),(o-i)%e==0?t.addClass("first"):(o-(i-1))%e==0&&t.addClass("last")})};if("scroll"==f.eventType){var l=""==f.customLoader?f.presetLoader:f.customLoader;n='<img src="'+l+'">',m(S).on("scroll touchstart",function(){m(this).trigger("yith_infs_start")}),m(S).on("yith_infs_start",function(){var t=m(this),e=m(f.itemSelector).last(),n=null!=yith_infs_script.elem_height?yith_infs_script.elem_height:2*e.height();void 0!==e&&!d&&!u&&t.scrollTop()+t.height()>=e.offset().top-n&&o()})}else"button"==f.eventType?(i='<div class="yith-infs-button-wrapper"><button id="yith-infs-button" class="'+f.buttonClass+'">'+f.buttonLabel+"</button></div>",m(f.navSelector).last().after(i),m(b).on("yith-infs-scroll-finished",function(){m(".yith-infs-button-wrapper").remove()}),m("#yith-infs-button").off("click").on("click",function(){var t=m(this);d||(e&&t.block({message:null,overlayCSS:{background:"#fff url("+e+") no-repeat center",opacity:.5,cursor:"none"}}),o()),m(b).on("yith_infs_adding_elem",function(){e&&t.unblock()})})):"pagination"==f.eventType&&m(b).off("click",f.navSelector+" a").on("click",f.navSelector+" a",function(t){t.preventDefault(),p=m(this).attr("href"),e&&m(f.navSelector).block({message:null,overlayCSS:{background:"#fff url("+e+") no-repeat center",opacity:.5,cursor:"none"}}),o()});m(S).on("scroll touchstart",function(t){var e,n,i=m(S),o=i.scrollTop()+i.height();void 0!==c&&v.length&&(e=y.indexOf(c),n=c.offset().top+c.height(),o<r?o<=n&&(c=y[e?e-1:e],a(v[e][0],v[e][1])):n+250<o&&(e+1<y.length&&(c=y[e+1]),a(v[e+1][0],v[e+1][1])),r=o)})}}(jQuery,window,document);
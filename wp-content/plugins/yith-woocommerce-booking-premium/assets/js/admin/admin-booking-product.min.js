jQuery(document).ready(function(r){"use strict";var n={message:"",css:{border:"none",background:"transparent"},overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0},o={message:" ",css:{border:"none",background:"#fff",top:"0",left:"0",height:"100%",width:"100%",opacity:.7,cursor:"default"},overlayCSS:{opacity:0},ignoreIfBlocked:!0},t=function(e){e.each(function(){var e=r(this);e.is("input")?"checkbox"===e.attr("type")?e.removeAttr("checked"):"text"!==e.attr("type")&&"number"!==e.attr("type")||e.val(""):e.is("textarea")&&e.val("")})},i=function(e){var i=!!e.length&&{};return e.each(function(){if(!1!==i){var e=r(this),t=e.data("name")||!1,n=e.data("required")||"no";t&&(e.is("input[type=checkbox]")?e.is(":checked")&&(i[t]=e.val()):i[t]=e.val()),"yes"===n&&""===e.val()&&(e.focus(),i=!1)}}),i},a=r("select#_yith_booking_duration_unit"),c=r("#_yith_booking_duration"),s={showPrefix:".bk_show_if_",enablePrefix:".bk_enable_if_",conditions:{customer_chooses_blocks:"customer_chooses_blocks",can_be_cancelled:"can_be_cancelled",customer_one_day:"customer_one_day",booking_has_persons:"booking_has_persons",day:"day",time:"time",fixed_and_time:"fixed_and_time",unit_is_month:"unit_is_month",unit_is_day:"unit_is_day",unit_is_hour:"unit_is_hour",unit_is_minute:"unit_is_minute",people_and_people_types:"people_and_people_types"},dom:{minuteSelect:r("#_yith_booking_duration_minute_select"),bookingDuration:c,bookingDurationType:r("select#_yith_booking_duration_type"),bookingDurationUnit:a,peopleEnabled:r("#_yith_booking_has_persons input"),peopleTypesEnabled:r("#_yith_booking_enable_person_types input"),productType:r("select#product-type")},initialProductType:"simple",init:function(){var o=s;o.initialProductType=o.dom.productType.val(),o.dom.minuteSelect.hide().on("change",function(){o.dom.bookingDuration.val(r(this).val())}),r(document).find("._tax_status_field").closest("div").addClass("show_if_"+wcbk_admin.prod_type),o.dom.productType.on("change",function(){s.initialProductType!==wcbk_admin.prod_type&&wcbk_admin.prod_type===r(this).val()&&r("#_virtual").attr("checked","checked").trigger("change")}).trigger("change"),o.dom.bookingDurationType.on("change",function(){o.handle(o.conditions.customer_chooses_blocks,"customer"===r(this).val())}).trigger("change"),r("#_yith_booking_can_be_cancelled input").on("change",function(){o.handle(o.conditions.can_be_cancelled,"yes"===r(this).val())}).trigger("change"),r(document).on("bk_check_if_customer_one_day",function(){var e=o.dom.bookingDurationType.val(),t=o.dom.bookingDuration.val(),n=o.dom.bookingDurationUnit.val(),i="customer"===e&&"1"===t&&"day"===n;o.handle(o.conditions.customer_one_day,i)}).trigger("bk_check_if_customer_one_day"),r(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration, #_yith_booking_duration_unit",function(){r(document).trigger("bk_check_if_customer_one_day")}),r(document).on("bk_check_if_fixed_and_time",function(){var e="fixed"===o.dom.bookingDurationType.val(),t=o.dom.bookingDurationUnit.val(),n="hour"===t||"minute"===t;o.handle(o.conditions.fixed_and_time,e&&n)}).trigger("bk_check_if_fixed_and_time"),r(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration_unit",function(){r(document).trigger("bk_check_if_fixed_and_time")}),o.dom.peopleEnabled.add(o.dom.peopleTypesEnabled).on("change",function(){o.handle(o.conditions.booking_has_persons,"yes"===o.dom.peopleEnabled.val()),o.handle(o.conditions.people_and_people_types,"yes"===o.dom.peopleEnabled.val()&&"yes"===o.dom.peopleTypesEnabled.val())}).trigger("change"),o.dom.bookingDurationUnit.on("change",function(){var e=r(this).val(),t="hour"===e||"minute"===e,n="day"===e;o.handle(o.conditions.time,t),o.handle(o.conditions.day,n),o.handle(o.conditions.unit_is_month,"month"===e),o.handle(o.conditions.unit_is_day,"day"===e),o.handle(o.conditions.unit_is_hour,"hour"===e),o.handle(o.conditions.unit_is_minute,"minute"===e),"minute"===e?(o.dom.bookingDuration.hide(),o.dom.minuteSelect.show().trigger("change")):(o.dom.minuteSelect.hide(),o.dom.bookingDuration.show()),r(document).trigger("yith_wcbk_booking_product_duration_unit_changed",[{value:e,has_time:t,is_day:n}])}).trigger("change")},handle:function(e,t){var n=s.enablePrefix+e,i=s.showPrefix+e;t?(r(n).unblock(),r(i).show()):(r(n).block(o),r(i).hide())}};s.init();var d=r("#yith-wcbk-booking-costs-table"),l=d.find("tr.yith-wcbk-costs-default-row").first(),e=r("#yith-wcbk-costs-add-range"),_=r("#"+d.data("fields-container-id")),u=_.find(".yith-wcbk-admin-input-range"),p=_.find(".yith-wcbk-number-range"),h=_.find(".yith-wcbk-month-range-select"),b=_.find(".yith-wcbk-week-range-select"),y=_.find(".yith-wcbk-day-range-select");d.on("change","select.yith-wcbk-costs-range-type-select",function(e){var t,n,i=r(e.target),o=i.closest("tr"),a=o.find("td.yith-wcbk-costs-from"),c=o.find("td.yith-wcbk-costs-to"),s=i.val();switch(s){case"custom":t=u.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker(),n=u.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker();break;case"month":t=h.clone(),n=h.clone();break;case"week":t=b.clone(),n=b.clone();break;case"day":t=y.clone(),n=y.clone();break;case"time":break;default:t=p.clone(),n=p.clone()}"time"===s?(t.find("input").attr("name","_yith_booking_costs_range[from][]"),n.find("input").attr("name","_yith_booking_costs_range[to][]")):(t.attr("name","_yith_booking_costs_range[from][]"),n.attr("name","_yith_booking_costs_range[to][]")),a.html(t),c.html(n)}).on("click",".yith-wcbk-delete",function(e){r(e.target).closest("tr").remove()}).find("tbody").sortable({items:"tr",cursor:"move",handle:".yith-wcbk-anchor",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,opacity:.65,helper:function(e,t){var n=t.children(),i=t.clone();return i.children().each(function(e){r(this).width(n.eq(e).width())}),i}}),e.on("click",function(){var e=l.clone().removeClass("yith-wcbk-costs-default-row");d.append(e),e.find("select.yith-wcbk-costs-range-type-select").trigger("change")}),r(".yith-wcbk-google-maps-places-autocomplete").each(function(){"undefined"!=typeof google&&"undefined"!=typeof google.maps&&"undefined"!=typeof google.maps.places&&"undefined"!=typeof google.maps.places.Autocomplete?new google.maps.places.Autocomplete(this):console.error("Google Maps Javascript API error while using Autocomplete. Probably other plugins (or your theme) include Google Maps Javascript API without support to the Places library")}),r(".yith-wcbk-product-sync-imported-calendars-table").on("click",".insert",function(e){e.preventDefault();var t,n=r(e.target),i=n.data("row"),o=n.closest(".yith-wcbk-product-sync-imported-calendars-table"),a=o.find("tbody");o.data("last-index")?t=o.data("last-index")+1:(t=a.find("tr").length||0,t+=1),o.data("last-index",t),i=i.replace(new RegExp("{{INDEX}}","g"),t),a.append(r(i))}).on("click",".delete",function(e){e.preventDefault(),r(e.target).closest("tr").remove()});var g=function(){var e,t,n,i=a.val(),o=c.val();t=o<2?(e=wcbk_admin.i18n_durations[i].singular.replace("%s",o),wcbk_admin.i18n_durations[i].singular_qty.replace("%s",o)):(e=wcbk_admin.i18n_durations[i].plural.replace("%s",o),wcbk_admin.i18n_durations[i].plural_qty.replace("%s",o)),n=wcbk_admin.i18n_durations[i].plural_unit,r(".yith-wcbk-product-metabox-dynamic-duration").html(e),r(".yith-wcbk-product-metabox-dynamic-duration-qty").html(t),r(".yith-wcbk-product-metabox-dynamic-duration-unit").html(n)};r(document).on("change","#_yith_booking_duration, #_yith_booking_duration_unit",g),r(document).on("yith_wcbk_product_metabox_dynamic_durations",g),g();var k={container:r("#yith-wcbk-people-types__create"),list:r("#yith-wcbk-people-types__list"),fields:r("#yith-wcbk-people-types__create .yith-wcbk-fake-form-field"),init:function(){var e=k;e.container.on("keydown",e.prevent_submit_on_enter).on("click",".yith-wcbk-people-types__create-submit",e.create).hide(),r("#yith-wcbk-people-types__create-btn").on("click",e.toggle)},close:function(){k.container.slideUp(200)},toggle:function(){k.container.slideToggle(200)},prevent_submit_on_enter:function(e){if(13===e.keyCode)return e.preventDefault(),!1},reset_form:function(){var e=k.fields;t(e)},get_form_data:function(){var e=k.fields;return i(e)},create:function(){var e=k.container,t=k.get_form_data();t&&(t.action="yith_wcbk_create_people_type",e.block(n),r.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e.message&&alert(e.message),e.id&&e.title&&(k.add_row(e.id,e.title),k.reset_form(),k.close())},complete:function(){e.unblock()}}))},add_row:function(e,t){var n=wp.template("yith-wcbk-people-type-row");k.list.append(r(n({id:e,title:t})))}};k.init();var m={container:r("#yith-wcbk-services__create"),fields:r("#yith-wcbk-services__create .yith-wcbk-fake-form-field"),services:r("#_yith_wcbk_booking_services"),init:function(){var e=m;e.container.on("keydown",e.prevent_submit_on_enter).on("click",".yith-wcbk-services__create-submit",e.create).hide(),r("#yith-wcbk-services__create-btn").on("click",e.toggle)},close:function(){m.container.slideUp(400)},toggle:function(){m.container.slideToggle(400)},prevent_submit_on_enter:function(e){if(13===e.keyCode)return e.preventDefault(),!1},reset_form:function(){var e=m.fields;t(e)},get_form_data:function(){var e=m.fields;return i(e)},create:function(){var e=m.container,t=m.get_form_data();t&&(t.action="yith_wcbk_create_service",e.block(n),r.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){if(e.message&&alert(e.message),e.id&&e.title){var t=r('<option value="'+e.id+'" selected="selected">'+e.title+"</option>");m.services.append(t),m.services.removeClass("enhanced"),r(document.body).trigger("wc-enhanced-select-init"),m.services.focus(),m.reset_form(),m.close()}e.debug&&console.log(e.debug)},complete:function(){e.unblock()}}))}};m.init();var f={list:r("#yith-wcbk-extra-costs__list"),customExtraCosts:!1,lastIndex:1,init:function(){this._initParams(),r("#yith-wcbk-extra-costs__new-extra-cost").on("click",this.addExtraCost),r(document).on("click",".yith-wcbk-extra-cost__delete",this.deleteExtraCost)},_initParams:function(){this.customExtraCosts=this.list.find(".yith-wcbk-extra-cost--custom"),this.lastIndex=this.customExtraCosts.length||0},nextIndex:function(){return++this.lastIndex},addExtraCost:function(e){e.preventDefault();var t,n=r(e.target).data("template"),i=f.nextIndex();n=n.replace(new RegExp("{{INDEX}}","g"),i),t=r(n),f.list.append(t),t.find(".yith-wcbk-extra-cost__name").first().focus()},deleteExtraCost:function(e){r(e.target).closest(".yith-wcbk-extra-cost").remove()}};f.init();var w={expandCollapseButton:r(".yith-wcbk-people-types__expand-collapse"),list:r("#yith-wcbk-people-types__list"),init:function(){this.expandCollapseButton.on("click",this.expandCollapseAll)},expandCollapseAll:function(e){var t=r(e.target).closest(".yith-wcbk-people-types__expand-collapse"),n=w.list;t.is(".yith-wcbk-people-types__expand-collapse--collapse")?(t.removeClass("yith-wcbk-people-types__expand-collapse--collapse"),n.find(".yith-wcbk-settings-section-box:not(.yith-wcbk-settings-section-box--closed) .yith-wcbk-settings-section-box__toggle").click()):(t.addClass("yith-wcbk-people-types__expand-collapse--collapse"),n.find(".yith-wcbk-settings-section-box.yith-wcbk-settings-section-box--closed .yith-wcbk-settings-section-box__toggle").click())}};w.init()});